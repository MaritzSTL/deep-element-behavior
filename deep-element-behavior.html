<script>
  window.deep = window.deep || {};

  ElementBehaviorImpl = {
    properties: {
      /* True if the element is visible to the user. False otherwise. */
      isVisible: {
        type: Boolean,
        value: false
      },
      /* Observer monitoring resize events */
      __resizeObserver: Object
    },
    attached() {
      this.__resizeObserver = new ResizeObserver(this.__updateVisibility);
      this.__resizeObserver.observe(this);
    },
    detached() {

    },
    __updateVisibility(resizeEntries) {
      if(!Array.isArray(resizeEntries) || !resizeEntries.length) return;
      const boundingRectangle = resizeEntries[0].contentRect;
      const {height, width} = boundingRectangle;
      this.set('isVisible', Boolean(height) || Boolean(width)); 
    }
  };
  deep.ElementBehavior = [ElementBehaviorImpl];
</script>
